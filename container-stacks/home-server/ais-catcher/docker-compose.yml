services:
  # ais-catcher
  ais-catcher:
    image: "ghcr.io/jvde-github/ais-catcher-control@sha256:0c65f9f071a4eda7fba5a6610d563c402b32cd638d7f0f447803f8d5c47ee804@sha256:69266c78f606495baf010cb83ac11220cee68a15c92051fdfda6f81d23066fc2"
    volumes:
      - /dev/bus/usb:/dev/bus/usb
      - data:/etc/AIS-catcher
      - /home/samue/ais/webassets:/etc/webassets
    # networks:
    #   reverse_proxy_private:
    ports:
      - 8100:8100
      - 8110:8110
    # labels:
      # traefik.enable: true
      # # Web Viewer Local
      # traefik.http.routers.ais.entrypoints: web
      # traefik.http.routers.ais.rule: Host(`ais.${DOMAINNAME}`)
      # traefik.http.routers.ais.service: ais-svc
      # traefik.http.services.ais-svc.loadbalancer.server.port: 8100
      # # Admin Local
      # traefik.http.routers.ais-admin.entrypoints: web
      # traefik.http.routers.ais-admin.rule: Host(`ais-admin.${DOMAINNAME}`)
      # traefik.http.routers.ais-admin.service: ais-admin-svc
      # traefik.http.services.ais-admin-svc.loadbalancer.server.port: 8110
      # # Web Viewer Public
      # traefik.http.routers.ais-public.service: ais-public-svc
      # traefik.http.services.ais-public-svc.loadbalancer.server.url: ais.${DOMAINNAME}
      # traefik.http.routers.ais-public.rule: Host(`ais.${ROOT_DOMAIN}`)
      # traefik.http.routers.ais-public.entrypoints: websecure
      # traefik.http.routers.ais-public.tls: true
      # traefik.http.routers.ais-public.tls.certresolver: letsencrypt
      # traefik.http.routers.ais-public.tls.domains[0].main: "${ROOT_DOMAIN}"
      # traefik.http.routers.ais-public.tls.domains[0].sans: "*.${ROOT_DOMAIN}"
      # traefik.http.routers.ais-public.middlewares: ais-public2
      # traefik.http.middlewares.ais-public2.replacepathregex.regex: ^/(robots.txt)"
      # traefik.http.middlewares.ais-public2.replacepathregex.replacement: /
    deploy:
      mode: replicated
      replicas: 1
      placement:
        constraints: [node.labels.features == sdr]

volumes:
  data:
    driver_opts:
      type: "nfs"
      o: "addr=192.168.0.200,nolock,rw"
      device: ":/volume2/docker-swarm/ais-catcher/data"
